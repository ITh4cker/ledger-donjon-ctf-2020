# picoHSM

## Building and flashing the STM32F205

The firmware for the STM32F205 can be built using CMake:

    cd firmware-mcu
    mkdir build && cd build
    cmake ../src
    make

To flash the microcontroller, be sure the jumpers on the board are configured
properly (JP1 and JP2 on the left), then run:

    make flash

This will flash the board with the default IP and MAC addresses. Other firmwares
with alternate IP and MAC are built by CMake and can be flashed as well:

    make flash11  # For IP ending in .11

## Building and flashing the ATMEGA1284P

The firmware for the ATMEGA1284P can be built using CMake:

    cd firmware-sec
    mkdir build && cd build
    cmake ../src
    make

To flash the microcontroller, connect the Atmel-ICE programmer to the ISP6
connector, and run:

    make flash
    make fuses

Flashing the fuse is important: it configures the microcontroller to use an
external clock (here the clock generated by the STM32F205), which is important
for the third challenge.
